<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>无标题文档</title>

<script>
 var xmlHttp;
 function uploadxls(contextPath){
  //判断是否选择了文件并且后缀是xls
     if(check()){
      //检验文件是否存在
      xlsfileupload(contextPath)
  }
    }
 //获取上传文件 文件名
 function getFileName(){
  //获取文件名
     var upfile = document.getElementById("uploadxlsfile").value;
     var allfilename = upfile.split("\\");
     var filename = allfilename[allfilename.length-1];
     return filename;
 }
    //
 function xlsfileupload(contextPath){

  document.uploadxlsform.action = contextPath+'/repository2.do?method=uploadXls';
  document.uploadxlsform.target="_self";
  document.uploadxlsform.submit();

  alert("通讯录更新完成！");
  window.close();

 }
  function submitAfter(req,res){
      var result = res.getAttr("result");
      if(null!=result&&""!=result){
              alert(result);
          }
     }
    //是否选择了文件并且后缀是xls文件判断
    function check(){
       var upfile = document.getElementById("uploadxlsfile").value;
       if(upfile=="" || upfile==null){
          return false;
       }
       if(upfile.endWith("xlsx")){
         return true;
       }else{
         alert("请上传通讯录文件！");
         return false;
       }
       return true;
     }
  String.prototype.endWith=function(oString){
    var   reg=new RegExp(oString+"$");
    return   reg.test(this);
 }
</script>
 </head>
 <body>
  <p>
  <div align="center">
   <form action="/testReport/" name="uploadxlsform" id="uploadxlsform" method="post" enctype="multipart/form-data">
    <table border="0" cellpadding="0" cellspacing="0" width="100%" id="table1" class="table_style">
     <tr class="table_th">
      <td style="text-align:left">
       &nbsp;&nbsp;请选择上传的通讯录文件：
      </td>
     </tr>
     <tr>
      <td style="height:60px;">
       <input type="file" name="uploadxlsfile" id="uploadxlsfile" size="60" />
      </td>
     </tr>
     </table>
     <table>
     <tr>
      <td>
       <input type="button" value="上 传" name="B1" class="button_common_skyBlue" onclick="uploadxls('<%=request.getContextPath()%>');" />
       &nbsp;&nbsp;
       <input type="reset"  value="重 置" name="B2" class="button_common_skyBlue" />
      </td>
     </tr>
    </table>
   </form>
  </div>
 </body>
</html>